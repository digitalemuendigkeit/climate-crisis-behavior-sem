---
title: "Additional Analysis Climate Crisis Behavior Study"
output: 
  distill::distill_article:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
library(tidyverse)
library(psych)
library(car)
library(Hmisc)
library(DT)
library(htmltools)
library(distill)
library(targets)
# Set targets tools
tar_config_set(here::here("_targets"))
source(here::here("R", "03_additional-analysis.R"))
knitr::opts_chunk$set(echo = TRUE)
# Get data
datalist <- tar_read("survey_data_addan")
descstat <- datalist$descriptive
data <- datalist$coded
col_order_1 <- c(
               grep(colnames(data), 
                    pattern = "Behavior ", 
                    value = TRUE),
               grep(colnames(data), 
                    pattern = "Behavioral", 
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Perceived Sel",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Perceived Response E",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Perceived Response C",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Perceived Sus",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Perceived Sev",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Norm",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Distr",
                    value = TRUE),
               grep(colnames(data),
                    pattern = "Know",
               value = TRUE))
col_order_2 <- c(colnames(data)[!colnames(data) %in% col_order_1])
col_order <- c(col_order_1, col_order_2)
data <- data[,col_order]
data[,grepl("COKN", colnames(data))] <- data[,grepl("COKN", colnames(data))] %>%
  lapply(FUN = function(x) car::recode(x,
    "1 = 'incorrect';
      2 = 'do not know';
      3 = 'correct'",
    as.factor = TRUE,
    levels = c('incorrect',
               'do not know',
               'correct')
  ))
data[,grepl("CCKN", colnames(data))] <- data[,grepl("CCKN", colnames(data))] %>%
  lapply(FUN = function(x) car::recode(x,
    "1 = 'incorrect';
      2 = 'do not know';
      3 = 'correct'",
    as.factor = TRUE,
    levels = c('incorrect',
               'do not know',
               'correct')
  ))
```

# Descriptive Statistics


```{r descstat, echo = FALSE}
datatable(
  descstat[,-2],
  filter = 'top',
  rownames = FALSE,
  caption = 'Descriptive statistics for all continuous variables',
  colnames = c("Cronbach\'s alpha" = "Cs.Alpha")
) %>%
  formatRound(-c(1:2,15),
              digits = 2)
```

For variables where a Cronbach's alpha $\geq$ 0.7 could not be attained, we chose the item with the highest item-total correlation or, in case of Internal and External Control Conviction, one of the items based on content.

# Correlation analysis of continous variables

As becomes apparent from the descriptive statistics, response data is not normally distributed.
Therefore, we use Spearman's rank correlation.

## Correlation of all Climate Crisis model variables, different Knowledge measures and Behavior

```{r ccrm, echo=FALSE, layout="l-page"}
ccrmv <- correlation_matrix_full(data %>%
                     select(starts_with("Climate Crisis") & !c(
                       ends_with("General"), 
                               ends_with("Diet"), 
                               ends_with("Heating"), 
                               ends_with("Driving")
                       )),
                   type = "spearman",
                   digits = 3,
                   replace_diagonal = TRUE,
                   replacement = "")
clrspal <- grDevices::colorRampPalette(c("#EE6677", "#FFFFFF", "#4477AA"))
brks <- seq(-0.9, 0.9, 0.01)
clrs <- clrspal(length(brks)+1)
ccrmvn <- data.frame(Variable = paste(1:17, rownames(ccrmv))) %>%
  cbind(as.data.frame(ccrmv) %>%
  rename_with(~ c(1:17)))
ccrmvn %>%
  datatable(caption = 'Spearman\'s rank correlation , *p < 0.05, ** p < 0.01, *** p < 0.001',
            rownames = FALSE,
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(ccrmv),
                           ordering = FALSE)) %>%
  formatStyle(names(ccrmvn[,-1]), 
              backgroundColor = styleInterval(brks, clrs))
```

This correlation table contains all variables corresponding to constructs in the model, albeit differently specified (see Descriptive Statistics table).
Further, Knowledge is specified differently: Instead of a pseudo-continuous scale with 1 corresponding to an incorrect answer, 2 to a 'don't know' and 3 to an correct answer, there are counts of how often a respondent answered correctly, incorrectly, or 'don't know'.
There is also a Subjective Knowledge variable which is a self-assessment of the amount of a respondent's climate crisis related knowledge.

Most of the correlations mirror relationships are already expressed in the model.
Additionally, there are the following correlations ($\rho > 0.3$) which all are significant at the p < 0.001 level:

Behavior is strongly correlated with Behavioral Intention, moderately correlated with Perceived Self-Efficacy, Perceived Response Efficacy and Personal Moral Norm, and weakly correlated with Perceived Susceptibility, Perceived Severity, Descriptive Norm, and Injunctive Norm.
It is also weakly and negatively correlated with all dimensions of Distrusting Beliefs in Science.

Behavioral Intention is strongly correlated with Perceived Self-Efficacy and Perceived Response Efficacy, moderately correlated with Perceived Susceptibility, Perceived Severity, and Personal Moral Norm, and weakly correlated with Perceived Response Costs, Descriptive Norm, Injunctive Norm, and Subjective Knowledge.
It is also weakly and negatively correlated with all dimensions of Distrusting Beliefs in Science.

All Response Beliefs lower-order constructs are intercorrelated, with the correlation between Perceived Self-Efficacy and Perceived Response Efficacy being strong, and those with Perceived Response Costs being weak.
Perceived Self-Efficacy and Perceived Response Efficacy are (at a minimum) moderately correlated with Perceived Susceptibility, Perceived Severity, Personal Moral Norm, and Descriptive Norm.
The relationship between Perceived Response Efficacy and Personal Moral Norm is strong, and Perceived Response Efficacy is weakly correlated with Subjective Knowledge.
Both Perceived Self-Efficacy and Perceived Response Efficacy are weakly and negatively correlated with all Distrust Beliefs variables.
Perceived Response Costs is weakly correlated with Personal Moral Norm.

Perceived Susceptibility and Perceived Severity are strongly intercorrelated.
Perceived Susceptibility is moderately correlated with Personal Moral Norm, and negatively and moderately correlated with the Distrusting Beliefs variables.
It is weakly correlated with Injunctive Norm and Descriptive Norm.
Perceived Severity on the other hand is strongly correlated with Personal Moral Norm, moderately positively correlated with Descriptive Norm, moderately negatively correlated with the Distrusting Beliefs variables, and weakly correlated with Injunctive Norm and the number of correct answers to Knowledge questions.

All normative variables are moderately intercorrelated.
Additionally, Personal Moral Norm is moderately and negatively correlated with the Distrusting Beliefs variables, and weakly correlated with Subjective Knowledge.
Descriptive Norm is weakly and negative correlated with all Distrusting Beliefs dimensions.

All Distrusting Beliefs variables are strongly intercorrelated.

Subjective Knowledge is weakly positively correlated with the number of correct answers, and negatively correlated with the number of questions respondents did not know an answer to.

## Correlation of behavior and behavioral intention

```{r ccrm3, echo=FALSE, layout="l-page"}
ccrmv3 <- correlation_matrix_full((data %>%
                     select(starts_with("Climate Crisis Behavior")
                       ))[,c(1:4,6:9)],
                   type = "spearman",
                   digits = 3,
                   replace_diagonal = TRUE,
                   replacement = "")
clrspal3 <- grDevices::colorRampPalette(c("#EE6677", "#FFFFFF", "#4477AA"))
brks3 <- brks
clrs3 <- clrs
ccrmvn3 <- data.frame(Variable = paste(1:8, rownames(ccrmv3))) %>%
  cbind(as.data.frame(ccrmv3) %>%
  rename_with(~ c(1:8)))
ccrmvn3 %>%
  datatable(caption = 'Spearman\'s rank correlation , *p < 0.05, ** p < 0.01, *** p < 0.001',
            rownames = FALSE,
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(ccrmv3),
                           ordering = FALSE)) %>%
  formatStyle(names(ccrmvn3[,-1]), 
              backgroundColor = styleInterval(brks3, clrs3))
```
The correlation between Diet, Driving, and General Behavior and Behavioral Intention is strong.
It is weak for Heating Behavior and Behavioral Intention.

## Correlation of all continuous variables with behavior and behavioral intention

```{r corall, echo=FALSE, include = FALSE}
ccrmv2 <- correlation_matrix_2(select(data, !starts_with("Climate Crisis Behavior") & 
                                        c(starts_with("Climate Crisis"),
                                          "COVID-19 Behavior",
                                          "COVID-19 Behavioral Intention",
                                          "Extraversion",
                                          "Agreeableness",
                                          "Neuroticism",
                                          "Openness to Experience",
                                          "Internal Control Conviction",
                                          "External Control Conviction",
                                          starts_with("Household"),
                                          "Age")),
                               select(data, starts_with("Climate Crisis Behavior")),
                   type = "spearman")
ccrmv2 <- ccrmv2[c(2:25,1,26,27:35),]
```
```{r corallvis, echo = FALSE, layout="l-page"}
ccrmv2numbers <- ccrmv2 %>%
                             unlist() %>%
                             substring(1,6) %>%
  as.numeric()
ccrmv2colors <- c()
for (i in 1:length(ccrmv2numbers)){
  ccrmv2colors[i] <- ifelse(brks[closestpos(ccrmv2numbers[i],brks)] < ccrmv2numbers[i],
                        clrs[closestpos(ccrmv2numbers[i],brks)],
                        clrs[closestpos(ccrmv2numbers[i],brks)+1])
}
ccrmv2clcyph <- data.frame(Names = ccrmv2 %>% unlist(),
                           Colors = ccrmv2colors)
ccrmv2 %>%
  as.data.frame() %>%
  datatable(caption = 'Spearman\'s rank correlation , *p < 0.05, ** p < 0.01, *** p < 0.001',
            options = list(list(className = 'dt-right',
                                targets = 0:6)),
            filter = 'top') %>%
  formatStyle(names(ccrmv2), 
               backgroundColor = styleEqual(ccrmv2clcyph$Names, ccrmv2clcyph$Colors)
  )
```



Next, we focus in on the correlations between all continuous variables and Behavioral Intention as well as Behavior and the different types of Behavior.
Apart from the correlations already discussed, it becomes apparent that correlations differ between the different types of Behavior.

COVID-19 Behavioral Intention and COVID-19 Behavior are both weakly correlated with Climate Crisis Behavioral Intention and Climate Crisis Behavior.
None of the Big Five variables show a substantial ($\rho > 0.3$) significant correlation with any type of Behavior or Behavioral Intention, nor do Internal or External Control Conviction
Further, there are no perceptible correlations for age, the household size, or the number of children living in the household.

# Kruskal-Wallis test and Wilcoxon signed-rank test for categorical variables
As the data for Behavior is non-parametric, we use the Kruskal Wallis test, the  Pairwise Wilcoxon Rank Sum test and the Wilcoxon-Mann-Whitney test to detect group differences. 

## Gender
```{r gender, echo = FALSE}
ggplot(data, aes(Gender, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'Gender')
wtg <- pairwise.wilcox.test(data$`Climate Crisis Behavior`, data$Gender, p.adjust="bonferroni", paired = FALSE)
wtg$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtg$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtg$p.value),
              digits = 3)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ `Gender`, data %>% filter(Gender != "other"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ `Gender`, data %>% filter(Gender != "other"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.female = median((data %>% filter(Gender == "female"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.male = median((data %>% filter(Gender == "male"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.female = mean((data %>% filter(Gender == "female"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.male = mean((data %>% filter(Gender == "male"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = 1,
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
```
There is a significant difference between male and female respondents, but the difference in median and mean values is insubstantial.

## Education
```{r education, echo = FALSE}
ggplot(data, aes(Education, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Education')
```

There is no significant difference in Behavior for different education levels.

## Occupation
```{r occupation, echo = FALSE}
ggplot(data, aes(Occupation, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Occupation')
wto <- pairwise.wilcox.test((data %>% filter(Occupation != "in vocational training" & Occupation != "student (school)"))$`Climate Crisis Behavior`, (data %>% filter(Occupation != "in vocational training" & Occupation != "student (school)"))$Occupation, p.adjust="bonferroni", paired = FALSE)
wto$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wto$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wto$p.value),
              digits = 3)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "employed full-time"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "employed full-time"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.student = median((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.eft = median((data %>% filter(Occupation == "employed full-time"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.student = mean((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.eft = mean((data %>% filter(Occupation == "employed full-time"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test: Student (university) and employed full-time',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = 1,
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "employed part-time"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "employed part-time"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.student = median((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.ept = median((data %>% filter(Occupation == "employed part-time"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.student = mean((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.ept = mean((data %>% filter(Occupation == "employed part-time"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test: Student (university) and employed part-time',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = 1,
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "not in paid employment"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ Occupation, data %>% filter(Occupation == "student (university)" | Occupation == "not in paid employment"), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.student = median((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.nipe = median((data %>% filter(Occupation == "not in paid employment"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.student = mean((data %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.nipe = mean((data %>% filter(Occupation == "not in paid employment"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test: Student (university) and not in paid employment',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = 1,
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
studentdata <- data %>% mutate(Occupation = car::recode(Occupation,
  "'student (university)' = 'student (university)';
  else = 'other'",
  as.factor = TRUE)
)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ Occupation, studentdata, na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ Occupation, studentdata, na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.student = median((studentdata %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.other = median((studentdata %>% filter(Occupation == "other"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.student = mean((studentdata %>% filter(Occupation == "student (university)"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.other = mean((studentdata %>% filter(Occupation == "other"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test: Student (university) and all others',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = 1,
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
```
There are significant difference for behavior according to occupation.
To further investigate these, a pairwise Wilcoxon Rank Sum Test could only be calculated when excluding the observations for student (school) and in vocational training.
University students report significantly stronger climate protective behavior than respondents who are employed full-time, part-time or report to be not in paid employment.

## Income
```{r income, echo = FALSE}
ggplot(data, aes(Income, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Income')
```
```{r income2, echo = FALSE, layout="l-page"}
wti <- pairwise.wilcox.test(data$`Climate Crisis Behavior`,data$Income, p.adjust="bonferroni")
wti$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wti$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wti$p.value),
              digits = 3)
```
There is a barely significant difference between some income groups.

## Dietary Habits (including diet behavior)
```{r dietex, echo = FALSE}
ggplot(data, aes(Diet, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Diet')
wtd <- pairwise.wilcox.test(data$`Climate Crisis Behavior`,data$Diet, p.adjust="bonferroni", paired = FALSE)
wtd$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtd$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtd$p.value),
              digits = 3)
```
There is a significant difference in climate protective behavior according to the dietary habits respondents report.
As the overall 'Behavior' variable also includes a measure of avoiding animal products, this is to be expected.

## Dietary Habits and Heating Behavior
```{r echo = FALSE}
ggplot(data, aes(Diet, `Climate Crisis Behavior Heating`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior Heating', 'Diet')
wtdh <- pairwise.wilcox.test(data$`Climate Crisis Behavior Heating`,data$Diet, p.adjust="bonferroni", paired = FALSE)
wtdh$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtdh$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtdh$p.value),
              digits = 3)
```


But the difference persists, albeit weaker, when considering differences in climate protective heating behavior (i.e., concsiously heating less).
For example, Respondents who report to eat meat every day report significantly less such climate protective behavior than all other groups.

## Dietary Habits and Driving Behavior

```{r echo = FALSE}
ggplot(data, aes(Diet, `Climate Crisis Behavior Driving`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior Driving', 'Diet')
wtdd <- pairwise.wilcox.test(data$`Climate Crisis Behavior Driving`,data$Diet, p.adjust="bonferroni", paired = FALSE)
wtdd$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtdd$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtdd$p.value),
              digits = 3)
```

A similar significant trend can be observed when it comes to driving, or the avoidance thereof to protect the climate.
Respondents who report to eat animal products often seem to be significantly less likely to avoid driving.

## Dietary Habits and General Behavior

```{r echo = FALSE}
ggplot(data, aes(Diet, `Climate Crisis Behavior General`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior General', 'Diet')
wtdg <- pairwise.wilcox.test(data$`Climate Crisis Behavior General`,data$Diet, p.adjust="bonferroni", paired = FALSE)
wtdg$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtdg$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtdg$p.value),
              digits = 3)
```

## Dietary Habits (excluding diet behavior)

```{r diet, echo = FALSE}
nodietdata <- data %>% 
  mutate(`Climate Crisis Behavior excluding Diet` = rowMeans(
    select(.,c(`Climate Crisis Behavior Driving`,
      `Climate Crisis Behavior Heating`,
      `Climate Crisis Behavior General`)), na.rm = TRUE))
ggplot(nodietdata, aes(Diet, `Climate Crisis Behavior excluding Diet`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(nodietdata, 'Climate Crisis Behavior excluding Diet', 'Diet')
wtd <- pairwise.wilcox.test(nodietdata$`Climate Crisis Behavior excluding Diet`,nodietdata$Diet, p.adjust="bonferroni", paired = FALSE)
wtd$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtd$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtd$p.value),
              digits = 3)
```

Similar differences can be observed in general climate protective behavior.

## Car Ownership
```{r co, echo = FALSE}
ggplot(data, aes(`Car Ownership`, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'Car Ownership')
wtco <- pairwise.wilcox.test(data$`Climate Crisis Behavior`, data$`Car Ownership`, p.adjust="bonferroni", paired = FALSE)
wtco$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtco$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtco$p.value),
              digits = 3)
data.frame(p = wilcox.test(`Climate Crisis Behavior` ~ `Car Ownership`, data %>% filter(!(`Car Ownership` == "does not own a car but can access one")), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value,
           Z = qnorm(wilcox.test(`Climate Crisis Behavior` ~ `Car Ownership`, data %>% filter(!(`Car Ownership` == "does not own a car but can access one")), na.action = "na.omit", paired = FALSE, p.adjust = "bonferroni")$p.value/2),
           Median.owns.car = median((data %>% filter(`Car Ownership` == "owns a car"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Median.doesnt.own.car = median((data %>% filter(`Car Ownership` == "does not own a car"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.owns.car = mean((data %>% filter(`Car Ownership` == "owns a car"))[,"Climate Crisis Behavior"], na.rm = TRUE),
           Mean.doesnt.own.car = mean((data %>% filter(`Car Ownership` == "does not own a car"))[,"Climate Crisis Behavior"], na.rm = TRUE)) %>%
  datatable(caption = 'Wilcoxon Rank Sum Test',
            autoHideNavigation = TRUE,
            rownames = FALSE,
            options = list(pageLength = nrow(wtco$p.value),
                           ordering = FALSE)) %>%
    formatRound(c(1:2,5:6),
              digits = 3)
```

There is a significant differences in Behavior between respondents who own a car and respondents who don't.
Again, one of the behavior questions asks for avoiding driving by car, so this is not too surprising.

## Car Ownership (excluding Driving Behavior)
```{r coex, echo = FALSE}
nodrivingdata <- data %>% 
  mutate(`Climate Crisis Behavior excluding Driving` = rowMeans(
    select(.,c(`Climate Crisis Behavior Diet`,
      `Climate Crisis Behavior Heating`,
      `Climate Crisis Behavior General`)), na.rm = TRUE))
ggplot(nodrivingdata, aes(`Car Ownership`, `Climate Crisis Behavior excluding Driving`)) +
  geom_boxplot()
kruskaldt(nodrivingdata, 'Climate Crisis Behavior', 'Car Ownership')
wtco <- pairwise.wilcox.test(nodrivingdata$`Climate Crisis Behavior excluding Driving`, nodrivingdata$`Car Ownership`, p.adjust="bonferroni", paired = FALSE)
wtco$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtco$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtco$p.value),
              digits = 3)
```
This difference vanishes when excluding Driving Behavior.

## Distance Driven for Business
```{r echo = FALSE}
ggplot(data, aes(`Distance Driven Business`, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Distance Driven Business')
wtdb <- pairwise.wilcox.test(data$`Climate Crisis Behavior`, data$`Distance Driven Business`, p.adjust="bonferroni", paired = FALSE)
wtdb$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtdb$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtdb$p.value),
              digits = 3)
```
There are some significant difference in behavior according to the reported differences driven for business in the last year.
No clear pattern emerges, though.

## Distance Driven Privately
```{r echo = FALSE}
ggplot(data, aes(`Distance Driven Private`, `Climate Crisis Behavior`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior', 'Distance Driven Private')
wtdp <- pairwise.wilcox.test(data$`Climate Crisis Behavior`, data$`Distance Driven Private`, p.adjust="bonferroni", paired = FALSE)
wtdp$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtdb$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtdp$p.value),
              digits = 3)
```

Respondents that report they have not driven by car in the last year at all also report overall higher climate protective behavior.
As with dietary climate protective behavior, this is to be expected as the overall climate protective behavior includes driving.

## Distance Driven Privately and Diet Behavior
```{r echo = FALSE}
ggplot(data, aes(`Distance Driven Private`, `Climate Crisis Behavior Diet`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior Diet', 'Distance Driven Private')
```

Accordingly, there is no significant difference when it comes to reported diet behavior.

## Distance Driven Privately and Heating Behavior
```{r echo = FALSE}
ggplot(data, aes(`Distance Driven Private`, `Climate Crisis Behavior Heating`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior Heating', 'Distance Driven Private')
```

Neither is there for heating behavior.

## Distance Driven Privately and General Behavior
```{r echo = FALSE}
ggplot(data, aes(`Distance Driven Private`, `Climate Crisis Behavior General`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(data, 'Climate Crisis Behavior General', 'Distance Driven Private')
```

There is no difference for general behavior, either.

## Distance Driven Privately (excluding Driving Behavior)
```{r echo = FALSE}
ggplot(nodrivingdata, aes(`Distance Driven Private`, `Climate Crisis Behavior excluding Driving`)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90))
kruskaldt(nodrivingdata, 'Climate Crisis Behavior excluding Driving', 'Distance Driven Private')
```
Nor is there a difference when excluding driving behavior.

## Knowledge
In this section, we examine the relationship between specific questions and Behavior as well as Subjective Knowledge.

### Today's global CO2 concentration in the atmosphere already occurred in the past 650,000 years. Correct answer: False.
```{r knowledge1, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN1)), aes(CCKN1, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN1')
wtbcckn1 <- pairwise.wilcox.test(data$`Climate Crisis Behavior`,data$CCKN1, p.adjust="bonferroni")
wtbcckn1$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtbcckn1$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtbcckn1$p.value),
              digits = 3)
ggplot(data %>% filter(!is.na(CCKN1)), aes(CCKN1, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN1')
wtscckn1 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN1, p.adjust="bonferroni")
wtscckn1$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn1$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn1$p.value),
              digits = 3)
```
Respondents who answer this question correctly show show significantly more behavior than those who do not, though the differences is marginal.
Similarly, there are significant though marginal differences in Subjective Knowledge.

### Despite its very low concentration in the atmosphere, nitrous oxide contributes about 6 % to the anthropogenic greenhouse effect, as its effect as a greenhouse gas is 298 times stronger than that of CO2. Correct answer: True.
```{r knowledge2, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN2)), aes(CCKN2, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN2')
ggplot(data %>% filter(!is.na(CCKN2)), aes(CCKN2, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN2')
wtscckn2 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN2, p.adjust="bonferroni")
wtscckn2$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn2$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn2$p.value),
              digits = 3)
```

For this question, there are only significant though marginal differences between Subjective Knowledge.

### CO2 usually remains in the atmosphere for between 10 and 20 years. Correct answer: False.
```{r knowledge3, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN3)), aes(CCKN3, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN3')
ggplot(data %>% filter(!is.na(CCKN3)), aes(CCKN3, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN3')
wtscckn3 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN3, p.adjust="bonferroni")
wtscckn3$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn3$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn3$p.value),
              digits = 3)
```
The same is true for this question.

### The Earth has been in a phase of rewarming from the Little Ice Age since about 1850, which is roughly the beginning of the Industrial Revolution. Correct answer: True.
```{r knowledge4, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN4)), aes(CCKN4, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN4')
ggplot(data %>% filter(!is.na(CCKN4)), aes(CCKN4, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN4')
wtscckn4 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN4, p.adjust="bonferroni")
wtscckn4$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn4$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn4$p.value),
              digits = 3)
```

Again, there are only significant though marginal differences between Subjective Knowledge.

### The ozone hole is one of the major causes of global warming. Correct answer: False.
```{r knowledge5, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN5)), aes(CCKN5, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN5')
wtbcckn5 <- pairwise.wilcox.test(data$`Climate Crisis Behavior`,data$CCKN5, p.adjust="bonferroni")
wtbcckn5$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtbcckn5$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtbcckn5$p.value),
              digits = 3)
ggplot(data %>% filter(!is.na(CCKN5)), aes(CCKN5, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN5')
wtscckn5 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN5, p.adjust="bonferroni")
wtscckn5$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn5$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn5$p.value),
              digits = 3)
```

There are marginal significant differences in both Behavior and Subjective Knowledge.

### Large volcanic eruptions significantly amplify global warming. Correct answer: False.
```{r knowledge6, echo = FALSE}
ggplot(data %>% filter(!is.na(CCKN6)), aes(CCKN6, `Climate Crisis Behavior`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Behavior', 'CCKN6')
ggplot(data %>% filter(!is.na(CCKN6)), aes(CCKN6, `Climate Crisis Subjective Knowledge`)) +
  geom_boxplot()
kruskaldt(data, 'Climate Crisis Subjective Knowledge', 'CCKN6')
wtscckn6 <- pairwise.wilcox.test(data$`Climate Crisis Subjective Knowledge`,data$CCKN6, p.adjust="bonferroni")
wtscckn6$p.value %>%
  datatable(caption = 'p-values of Pairwise Wilcoxon Rank Sum Tests adjusted using Bonferroni correction',
            autoHideNavigation = TRUE,
            options = list(pageLength = nrow(wtscckn6$p.value),
                           ordering = FALSE)) %>%
    formatRound(1:ncol(wtscckn6$p.value),
              digits = 3)
```

As before, there are significant though marginal differences in Subjective Knowledge.

<!-- ```{r table-getter} -->
<!-- ds <- descstat[,c(1,16,3,15,4:5)] %>%  -->
<!--   filter(grepl("Climate", Variable)) -->
<!-- ds$Variable <- sub("Climate Crisis ", "", ds$Variable) -->
<!-- ds <- ds[c(1:2,5,3:4,6,16,20,24,28:30,11,15,12:14,31),] %>% -->
<!--   mutate(across(4:6, ~ round(.x, digits = 2))) -->
<!-- write_excel_csv(ds, "paper/descriptive-statistics.csv",delim = ";") -->
<!-- ``` -->

